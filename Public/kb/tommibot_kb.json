{
  "metadata": {
    "kb_version": "1.0.0",
    "scope": "Sistema de reservas y pr√©stamos - Colegio Juan Tomis Stack",
    "last_updated": "2025-11-01"
  },
  "business_rules": {
    "cancelacion_plazo": "Solo se puede cancelar hasta el fin del d√≠a de la reserva.",
    "prestamo_devolucion": "La devoluci√≥n se marca cuando el encargado confirma la inspecci√≥n f√≠sica.",
    "pdf_envio_email": "Todo PDF generado tambi√©n se env√≠a al correo del docente.",
    "verificacion_sms": "Antes de crear reserva, pr√©stamo o cambiar contrase√±a, se requiere verificaci√≥n por SMS.",
    "reintentos_sms": 3
  },
  "screens": {
    "reservas": {"images": ["img/reservas.png"]},
    "prestamo": {"images": ["img/prestamo.png"]},
    "historial": {"images": ["img/historial.png"]},
    "cambiar_contrasena": {"images": ["img/cambiar_contrasena.png"]},
    "devolucion": {"images": ["img/devolucion.png"]}
  },
  "intents": {
    "reservar": {
      "keywords": ["reserv", "aula", "agendar", "calendario"],
      "template": {
        "steps_only": true,
        "steps": [
          "Entra a Reservas en tu panel.",
          "Se enviar√° autom√°ticamente un c√≥digo SMS a tu n√∫mero registrado.",
          "Ingresa el c√≥digo de 6 d√≠gitos en la ventana que aparece para verificarte.",
          "Luego selecciona la fecha (DD/MM/AAAA) y la hora.",
          "Selecciona el aula correspondiente.",
          "(Opcional) Agrega una descripci√≥n si lo necesitas.",
          "Confirma para registrar la reserva.",
          "Consulta tu Historial para ver la reserva registrada."
        ]
      }
    },
    "prestamo": {
      "keywords": ["pr√©stamo", "prestamo", "equipo", "proyector", "laptop"],
      "template": {
        "steps_only": true,
        "steps": [
          "Entra a Pr√©stamo en tu panel.",
          "Se enviar√° autom√°ticamente un c√≥digo SMS a tu n√∫mero registrado.",
          "Ingresa el c√≥digo de 6 d√≠gitos en la ventana que aparece para verificarte.",
          "Selecciona fecha de pr√©stamo (a partir de ma√±ana).",
          "Elige el/los equipos necesarios (Laptop, Proyector, Extension, etc.).",
          "Selecciona el aula y la hora de inicio (y fin si aplica).",
          "Confirma para registrar el pr√©stamo.",
          "El Encargado validar√° la entrega f√≠sica. Revisa el estado en tu Historial."
        ]
      }
    },
    "cambiar_contrasena": {
      "keywords": ["contrase√±a", "password", "clave", "cambiar"],
      "template": {
        "steps_only": true,
        "steps": [
          "Abre Cambiar contrase√±a en tu panel.",
          "Si eres Profesor, se enviar√° autom√°ticamente un c√≥digo SMS a tu n√∫mero registrado.",
          "Ingresa el c√≥digo de 6 d√≠gitos en la ventana para verificarte (solo Profesores).",
          "Escribe tu contrase√±a actual y la nueva (m√≠n. 8, con may√∫scula, n√∫mero y car√°cter especial).",
          "Confirma para actualizar la contrase√±a. Ver√°s una confirmaci√≥n en pantalla."
        ]
      }
    },
    "historial": {
      "keywords": ["historial", "descargar", "pdf", "reportes"],
      "template": {
        "steps_only": true,
        "steps": [
          "Abre Historial en tu panel.",
          "Filtra por fecha o tipo si lo necesitas.",
          "Haz clic en Descargar PDF para obtener el reporte.",
          "El PDF tambi√©n se env√≠a autom√°ticamente a tu correo institucional."
        ]
      }
    },
    "cancelar": {
      "keywords": ["cancelar", "anular"],
      "template": {
        "steps_only": true,
        "steps": [
          "Ve a Historial y ubica la reserva que quieres cancelar.",
          "Si a√∫n est√°s dentro del mismo d√≠a de la reserva, ver√°s la opci√≥n Cancelar.",
          "Confirma la cancelaci√≥n. La reserva se eliminar√° y quedar√° registrada la acci√≥n.",
          "Si ya pas√≥ el d√≠a, la cancelaci√≥n no est√° permitida."
        ]
      }
    },
    "devolucion": {
      "keywords": ["devoluci√≥n", "devolucion", "devolver"],
      "template": {
        "steps_only": true,
        "steps": [
          "Lleva el equipo al Encargado en el horario acordado.",
          "El Encargado inspecciona el equipo y registra la devoluci√≥n en el sistema.",
          "Ver√°s el estado actualizado en tu Historial."
        ]
      }
    },
    "notificaciones": {
      "keywords": ["notificacion", "notificaci√≥n", "campana", "alerta", "correo"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en la campana del encabezado para ver tus notificaciones recientes.",
          "Revisa la lista y abre el detalle si corresponde.",
          "Puedes marcar todas como le√≠das desde el bot√≥n del listado.",
          "Tambi√©n recibir√°s avisos por correo seg√∫n tu actividad."
        ]
      }
    },
    "reenviar_codigo": {
      "keywords": ["reenviar", "reenv√≠o", "reenviar codigo", "no me llego codigo", "no lleg√≥ sms", "no me llego sms", "reenviar sms"],
      "template": {
        "steps_only": true,
        "steps": [
          "En la ventana de verificaci√≥n, haz clic en \"Reenviar\" para solicitar un nuevo c√≥digo.",
          "Espera 60 segundos antes de volver a intentar (enlace con contador).",
          "Si no llega, verifica que tu n√∫mero est√© en formato +51XXXXXXXXX en tu perfil."
        ]
      }
    },
    "gestion_usuarios": {
      "keywords": ["gestionar usuarios", "agregar usuario", "crear profesor", "eliminar usuario", "editar usuario", "administrar usuarios"],
      "template": {
        "steps_only": true,
        "steps": [
          "Accede al panel de Administrador.",
          "Selecciona la opci√≥n 'Gestionar Usuarios'.",
          "Puedes agregar nuevos usuarios (Profesores, Administradores, Encargados).",
          "Editar informaci√≥n de usuarios existentes (nombre, correo, tel√©fono, contrase√±a).",
          "Desactivar o eliminar usuarios que ya no pertenecen al sistema.",
          "Todos los cambios se reflejan inmediatamente en el sistema."
        ]
      }
    },
    "reportes_estadisticas": {
      "keywords": ["reportes", "estad√≠sticas", "gr√°ficos", "filtros", "exportar", "dashboard", "analytics"],
      "template": {
        "steps_only": true,
        "steps": [
          "Ve a 'Reportes / Filtros' en el men√∫ de Administrador.",
          "Puedes filtrar por: fecha, profesor, aula, turno, tipo (reserva/pr√©stamo).",
          "Visualiza los resultados en tabla.",
          "Descarga reportes en formato PDF con dise√±o institucional.",
          "Accede a 'Estad√≠sticas' para ver gr√°ficos, rankings de aulas m√°s usadas, horas pico, etc.",
          "Todos los PDFs incluyen logo del colegio, tu nombre, rol y fecha de descarga."
        ]
      }
    },
    "validar_prestamo": {
      "keywords": ["validar pr√©stamo", "aprobar pr√©stamo", "entregar equipo", "confirmar entrega"],
      "template": {
        "steps_only": true,
        "steps": [
          "El Encargado accede al panel de 'Pr√©stamos Pendientes'.",
          "Verifica la identidad del docente y el equipo solicitado.",
          "Inspecciona el estado f√≠sico del equipo antes de entregarlo.",
          "Confirma la entrega en el sistema haciendo clic en 'Validar Pr√©stamo'.",
          "El estado del pr√©stamo cambia a 'Activo' y el docente puede ver esto en su Historial."
        ]
      }
    },
    "registrar_devolucion": {
      "keywords": ["registrar devoluci√≥n", "marcar devuelto", "devolver equipo", "inspeccionar equipo"],
      "template": {
        "steps_only": true,
        "steps": [
          "El docente devuelve el equipo al Encargado.",
          "El Encargado inspecciona el equipo para verificar su estado.",
          "Accede a 'Devoluciones' en su panel.",
          "Selecciona el pr√©stamo correspondiente.",
          "Marca como devuelto y opcionalmente agrega un comentario (si hay da√±os o incidencias).",
          "El docente ver√° la devoluci√≥n registrada en su Historial."
        ]
      }
    },
    "perfil": {
      "keywords": ["mi perfil", "editar perfil", "actualizar datos", "cambiar tel√©fono", "cambiar correo"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en tu nombre de usuario en la esquina superior derecha.",
          "Selecciona 'Mi Perfil'.",
          "Puedes actualizar: nombre completo, correo electr√≥nico, n√∫mero de tel√©fono.",
          "El tel√©fono debe estar en formato +51XXXXXXXXX para recibir SMS.",
          "Guarda los cambios y ver√°s una confirmaci√≥n."
        ]
      }
    },
    "anticipacion": {
      "keywords": ["anticipaci√≥n", "1 d√≠a", "ma√±ana", "cu√°ndo puedo reservar", "plazo"],
      "template": {
        "steps_only": true,
        "steps": [
          "‚ö†Ô∏è IMPORTANTE: Todas las reservas y pr√©stamos requieren m√≠nimo 1 d√≠a de anticipaci√≥n.",
          "Esto significa que NO puedes reservar para hoy.",
          "La fecha m√°s pr√≥xima disponible es ma√±ana.",
          "Esta validaci√≥n se aplica tanto en frontend como en backend.",
          "Si intentas hacerlo para hoy, el sistema te mostrar√° un error."
        ]
      }
    },
    "ayuda_general": {
      "keywords": ["ayuda", "soporte", "contacto", "problema t√©cnico", "error del sistema"],
      "template": {
        "steps_only": true,
        "steps": [
          "Si tienes problemas t√©cnicos que no puedo resolver, contacta al administrador del sistema.",
          "Para dudas sobre pol√≠ticas internas del colegio, consulta con Direcci√≥n.",
          "Para reportar errores o bugs, env√≠a un correo a soporte con detalles del problema.",
          "Estoy aqu√≠ para ayudarte con preguntas sobre c√≥mo usar el sistema. üòä"
        ]
      }
    }
  },
  "voice_commands": {
    "navigate": {
      "keywords": ["ir a", "abre", "mu√©strame", "ll√©vame a", "navega a"],
      "actions": {
        "reservas": {"url": "?view=reservas", "description": "Abrir m√≥dulo de Reservas"},
        "prestamo": {"url": "?view=prestamo", "description": "Abrir m√≥dulo de Pr√©stamos"},
        "historial": {"url": "?view=historial", "description": "Abrir Historial"},
        "contrase√±a": {"url": "?view=password", "description": "Cambiar contrase√±a"},
        "tommibot": {"url": "?view=tommibot", "description": "Abrir Tommibot"},
        "usuarios": {"url": "?view=usuarios", "description": "Gestionar usuarios (Admin)"},
        "reportes": {"url": "?view=reportes", "description": "Ver reportes (Admin)"},
        "estadisticas": {"url": "?view=estadisticas", "description": "Ver estad√≠sticas (Admin)"},
        "devolucion": {"url": "?view=devolucion", "description": "Gestionar devoluciones (Encargado)"}
      }
    },
    "download": {
      "keywords": ["descargar", "descarga", "pdf", "exportar"],
      "description": "Descarga el PDF del historial actual"
    },
    "help": {
      "keywords": ["ayuda", "comandos", "qu√© puedes hacer", "opciones"],
      "description": "Muestra lista de comandos de voz disponibles"
    }
  },
  "faqs": {
    "sms_no_llega": {
      "question": "¬øQu√© hago si no me llega el SMS?",
      "answer": "Verifica que tu n√∫mero en el perfil est√© en formato +51XXXXXXXXX. Si est√° correcto, usa el bot√≥n 'Reenviar' (espera 60 seg). Si sigue sin llegar, contacta al administrador."
    },
    "cancelar_fuera_plazo": {
      "question": "¬øPuedo cancelar una reserva de ayer?",
      "answer": "No, solo se pueden cancelar reservas el mismo d√≠a. Si ya pas√≥ el d√≠a, la reserva queda registrada en el historial."
    },
    "equipo_danado": {
      "question": "¬øQu√© pasa si da√±o un equipo?",
      "answer": "Informa inmediatamente al Encargado. √âl registrar√° el incidente en la devoluci√≥n con un comentario. Luego se aplicar√°n las pol√≠ticas del colegio sobre equipos da√±ados."
    },
    "cambiar_reserva": {
      "question": "¬øPuedo modificar una reserva?",
      "answer": "No hay opci√≥n de edici√≥n directa. Deber√°s cancelar la reserva (si est√°s en el mismo d√≠a) y crear una nueva."
    }
  },
  "out_of_scope": {
    "examples": ["clima", "capital de", "noticias", "m√∫sica", "juego"],
    "response": {
      "summary": "Puedo responder preguntas generales con IA, pero mi especialidad es el sistema.",
      "steps": [
        "Puedo ayudarte con: reservas, pr√©stamos, historial, contrase√±as, devoluciones, reportes, estad√≠sticas, gesti√≥n de usuarios.",
        "Dime qu√© tarea del sistema quieres realizar y te gu√≠o paso a paso.",
        "Tambi√©n puedo responder preguntas generales como: ¬øQu√© hora es? ¬øCu√°l es la capital de Per√∫? ¬øCu√©ntame un chiste!"
      ]
    }
  },
  "system_info": {
    "name": "Sistema de Reservas y Pr√©stamos AIP",
    "institution": "Colegio Juan Tomis Stack",
    "version": "2.0",
    "features": [
      "Reserva de aulas con verificaci√≥n SMS",
      "Pr√©stamo de equipos (Laptop, Proyector, Extensi√≥n, etc.)",
      "Historial completo con descargas PDF",
      "Gesti√≥n de usuarios (Admin)",
      "Reportes y estad√≠sticas avanzadas (Admin)",
      "Control de devoluciones (Encargado)",
      "Notificaciones en tiempo real",
      "Cambio de contrase√±a seguro",
      "Chatbot inteligente (Tommibot) con IA y comandos de voz"
    ],
    "roles": {
      "Profesor": "Puede hacer reservas, pr√©stamos, ver historial, cambiar contrase√±a.",
      "Administrador": "Gesti√≥n completa de usuarios, reportes, estad√≠sticas, configuraci√≥n del sistema.",
      "Encargado": "Validar pr√©stamos, registrar devoluciones, controlar equipos y aulas."
    }
  }
}
