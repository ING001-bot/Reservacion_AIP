{
  "metadata": {
    "kb_version": "1.0.0",
    "scope": "Sistema de reservas y pr√©stamos - Colegio Juan Tomis Stack",
    "last_updated": "2025-11-01"
  },
  "business_rules": {
    "separacion_aulas": "IMPORTANTE: Las aulas AIP (AIP1, AIP2) son EXCLUSIVAS para reservas de aula. Las aulas REGULARES son EXCLUSIVAS para pr√©stamos de equipos. En el m√≥dulo de Reservas solo aparecer√°n aulas tipo AIP. En el m√≥dulo de Pr√©stamos solo aparecer√°n aulas tipo REGULAR.",
    "cancelacion_plazo": "Solo se puede cancelar hasta el fin del d√≠a de la reserva.",
    "prestamo_devolucion": "La devoluci√≥n se marca cuando el encargado confirma la inspecci√≥n f√≠sica.",
    "pdf_envio_email": "Todo PDF generado tambi√©n se env√≠a al correo del docente.",
    "verificacion_sms": "Antes de crear reserva, pr√©stamo o cambiar contrase√±a, se requiere verificaci√≥n por SMS (solo Profesores).",
    "reintentos_sms": 3
  },
  "screens": {
    "reservas": {"images": ["img/reservas.png"]},
    "prestamo": {"images": ["img/prestamo.png"]},
    "historial": {"images": ["img/historial.png"]},
    "cambiar_contrasena": {"images": ["img/cambiar_contrasena.png"]},
    "devolucion": {"images": ["img/devolucion.png"]}
  },
  "intents": {
    "reservar": {
      "keywords": ["reserv", "aula", "agendar", "calendario"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en 'Reservar Aula' en tu panel de Profesor.",
          "üîê AUTOM√ÅTICAMENTE se enviar√° un c√≥digo SMS de 6 d√≠gitos a tu tel√©fono registrado.",
          "Ingresa el c√≥digo en la ventana emergente para verificarte (tienes 10 minutos).",
          "‚úÖ Una vez verificado, podr√°s ver el calendario de disponibilidad.",
          "Selecciona la fecha (DD/MM/AAAA) - recuerda que debe ser a partir de MA√ëANA (m√≠nimo 1 d√≠a de anticipaci√≥n).",
          "Elige el horario (entre 06:00-19:00 hrs).",
          "Selecciona el aula AIP disponible - IMPORTANTE: Solo ver√°s aulas tipo AIP (AIP1, AIP2, etc.). Las aulas REGULARES NO aparecen aqu√≠ porque son exclusivas para pr√©stamos de equipos.",
          "Confirma para registrar la reserva.",
          "üìß Recibir√°s confirmaci√≥n por correo y campanita de notificaci√≥n.",
          "Puedes ver tu reserva en 'Mi Historial'."
        ]
      }
    },
    "prestamo": {
      "keywords": ["pr√©stamo", "prestamo", "equipo", "proyector", "laptop"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en 'Pr√©stamo de Equipos' en tu panel de Profesor.",
          "üîê AUTOM√ÅTICAMENTE se enviar√° un c√≥digo SMS de 6 d√≠gitos a tu tel√©fono registrado.",
          "Ingresa el c√≥digo en la ventana emergente para verificarte (tienes 10 minutos).",
          "‚úÖ Una vez verificado, podr√°s seleccionar equipos.",
          "Selecciona la fecha de pr√©stamo (a partir de MA√ëANA - m√≠nimo 1 d√≠a de anticipaci√≥n).",
          "Elige el tipo de equipo (Laptop, Proyector, Extensi√≥n, etc.) seg√∫n stock disponible.",
          "Selecciona los equipos espec√≠ficos que necesites.",
          "Define el aula REGULAR donde usar√°s los equipos - IMPORTANTE: Solo ver√°s aulas tipo REGULAR. Las aulas AIP NO aparecen aqu√≠ porque se reservan por separado.",
          "Define el horario de uso (hora inicio y fin).",
          "Confirma para registrar el pr√©stamo.",
          "üìß Recibir√°s confirmaci√≥n por correo y campanita de notificaci√≥n.",
          "El Encargado validar√° la entrega f√≠sica del equipo.",
          "Revisa el estado en 'Mi Historial'."
        ]
      }
    },
    "cambiar_contrasena": {
      "keywords": ["contrase√±a", "password", "clave", "cambiar"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en 'Cambiar Contrase√±a' en tu panel.",
          "üîê Si eres PROFESOR: AUTOM√ÅTICAMENTE se enviar√° un c√≥digo SMS de 6 d√≠gitos a tu tel√©fono.",
          "Ingresa el c√≥digo en la ventana emergente para verificarte (solo Profesores).",
          "‚úÖ Una vez verificado, ingresa tu contrase√±a actual.",
          "Escribe tu nueva contrase√±a (m√≠nimo 6 caracteres).",
          "Confirma la nueva contrase√±a.",
          "Haz clic en 'Actualizar contrase√±a'.",
          "Ver√°s una confirmaci√≥n en pantalla.",
          "‚ö†Ô∏è IMPORTANTE: Admin y Encargado NO requieren SMS para cambiar contrase√±a."
        ]
      }
    },
    "historial": {
      "keywords": ["historial", "descargar", "pdf", "reportes"],
      "template": {
        "steps_only": true,
        "steps": [
          "Abre Historial en tu panel.",
          "Filtra por fecha o tipo si lo necesitas.",
          "Haz clic en Descargar PDF para obtener el reporte.",
          "El PDF tambi√©n se env√≠a autom√°ticamente a tu correo institucional."
        ]
      }
    },
    "cancelar": {
      "keywords": ["cancelar", "anular"],
      "template": {
        "steps_only": true,
        "steps": [
          "Ve a Historial y ubica la reserva que quieres cancelar.",
          "Si a√∫n est√°s dentro del mismo d√≠a de la reserva, ver√°s la opci√≥n Cancelar.",
          "Confirma la cancelaci√≥n. La reserva se eliminar√° y quedar√° registrada la acci√≥n.",
          "Si ya pas√≥ el d√≠a, la cancelaci√≥n no est√° permitida."
        ]
      }
    },
    "devolucion": {
      "keywords": ["devoluci√≥n", "devolucion", "devolver"],
      "template": {
        "steps_only": true,
        "steps": [
          "Lleva el equipo al Encargado en el horario acordado.",
          "El Encargado inspecciona el equipo y registra la devoluci√≥n en el sistema.",
          "Ver√°s el estado actualizado en tu Historial."
        ]
      }
    },
    "notificaciones": {
      "keywords": ["notificacion", "notificaci√≥n", "campana", "alerta", "correo"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en la campana del encabezado para ver tus notificaciones recientes.",
          "Revisa la lista y abre el detalle si corresponde.",
          "Puedes marcar todas como le√≠das desde el bot√≥n del listado.",
          "Tambi√©n recibir√°s avisos por correo seg√∫n tu actividad."
        ]
      }
    },
    "reenviar_codigo": {
      "keywords": ["reenviar", "reenv√≠o", "reenviar codigo", "no me llego codigo", "no lleg√≥ sms", "no me llego sms", "reenviar sms"],
      "template": {
        "steps_only": true,
        "steps": [
          "En la ventana de verificaci√≥n, haz clic en \"Reenviar\" para solicitar un nuevo c√≥digo.",
          "Espera 60 segundos antes de volver a intentar (enlace con contador).",
          "Si no llega, verifica que tu n√∫mero est√© en formato +51XXXXXXXXX en tu perfil."
        ]
      }
    },
    "gestion_usuarios": {
      "keywords": ["gestionar usuarios", "agregar usuario", "crear profesor", "eliminar usuario", "editar usuario", "administrar usuarios"],
      "template": {
        "steps_only": true,
        "steps": [
          "Accede al panel de Administrador (solo disponible para Administradores).",
          "Haz clic en 'Usuarios' en el men√∫ lateral.",
          "Para AGREGAR: Clic en 'Nuevo Usuario' ‚Üí completa nombre, correo, tel√©fono, tipo (Profesor/Admin/Encargado) ‚Üí Guardar.",
          "Para EDITAR: Clic en el √≠cono de l√°piz ‚Üí modifica los campos ‚Üí Guardar cambios.",
          "Para ELIMINAR: Clic en el √≠cono de basura ‚Üí confirma la eliminaci√≥n (soft delete).",
          "‚ö†Ô∏è El correo debe ser √∫nico y v√°lido (se verifica por SMTP).",
          "‚ö†Ô∏è El tel√©fono debe estar en formato +51XXXXXXXXX.",
          "Todos los cambios se reflejan inmediatamente en el sistema.",
          "Los nuevos usuarios recibir√°n un correo de verificaci√≥n."
        ]
      }
    },
    "reportes_estadisticas": {
      "keywords": ["reportes", "estad√≠sticas", "gr√°ficos", "filtros", "exportar", "dashboard", "analytics"],
      "template": {
        "steps_only": true,
        "steps": [
          "Ve a 'Reportes / Filtros' en el men√∫ de Administrador.",
          "Selecciona los filtros que necesites: fecha (desde-hasta), profesor, aula, turno, tipo (reserva/pr√©stamo).",
          "Haz clic en 'Aplicar Filtros' para ver los resultados en tabla.",
          "Para ver ESTAD√çSTICAS: Haz clic en 'Estad√≠sticas' en el men√∫.",
          "Ver√°s gr√°ficos interactivos con: total de reservas/pr√©stamos, equipos m√°s solicitados, profesores m√°s activos, aulas m√°s usadas, etc.",
          "Descarga reportes en formato PDF con dise√±o institucional.",
          "Los PDFs incluyen logo del colegio, tu nombre, rol y fecha de descarga.",
          "Tambi√©n puedes exportar los datos para an√°lisis externo."
        ]
      }
    },
    "validar_prestamo": {
      "keywords": ["validar pr√©stamo", "aprobar pr√©stamo", "entregar equipo", "confirmar entrega"],
      "template": {
        "steps_only": true,
        "steps": [
          "Como Encargado, accede a tu panel.",
          "Ve a 'Pr√©stamos Pendientes' (o similar en tu men√∫).",
          "Verifica la identidad del docente que solicita el equipo.",
          "Inspecciona f√≠sicamente el equipo antes de entregarlo (estado, funcionamiento).",
          "Confirma la entrega en el sistema haciendo clic en 'Validar Pr√©stamo'.",
          "El estado del pr√©stamo cambia a 'Activo'.",
          "El docente ver√° esto actualizado en su Historial.",
          "üìß Se enviar√°n notificaciones al profesor y administrador."
        ]
      }
    },
    "registrar_devolucion": {
      "keywords": ["registrar devoluci√≥n", "marcar devuelto", "devolver equipo", "inspeccionar equipo"],
      "template": {
        "steps_only": true,
        "steps": [
          "El docente te devuelve el equipo en el horario acordado.",
          "Como Encargado, inspecciona F√çSICAMENTE el equipo (estado, da√±os, funcionamiento).",
          "Accede a 'Devoluciones' en tu panel de Encargado.",
          "Selecciona el pr√©stamo correspondiente en la lista.",
          "Marca como 'Devuelto'.",
          "OPCIONAL: Agrega un comentario si hay da√±os o incidencias (Ej: 'Ray√≥n en pantalla', 'Todo OK').",
          "Confirma la devoluci√≥n.",
          "El stock del equipo se incrementa autom√°ticamente.",
          "El docente ver√° la devoluci√≥n registrada en su Historial.",
          "üìß Se enviar√°n notificaciones al profesor y administrador con tu observaci√≥n."
        ]
      }
    },
    "perfil": {
      "keywords": ["mi perfil", "editar perfil", "actualizar datos", "cambiar tel√©fono", "cambiar correo"],
      "template": {
        "steps_only": true,
        "steps": [
          "Haz clic en tu nombre de usuario en la esquina superior derecha.",
          "Selecciona 'Mi Perfil'.",
          "Puedes actualizar: nombre completo, correo electr√≥nico, n√∫mero de tel√©fono.",
          "El tel√©fono debe estar en formato +51XXXXXXXXX para recibir SMS.",
          "Guarda los cambios y ver√°s una confirmaci√≥n."
        ]
      }
    },
    "anticipacion": {
      "keywords": ["anticipaci√≥n", "1 d√≠a", "ma√±ana", "cu√°ndo puedo reservar", "plazo"],
      "template": {
        "steps_only": true,
        "steps": [
          "‚ö†Ô∏è IMPORTANTE: Todas las reservas y pr√©stamos requieren m√≠nimo 1 d√≠a de anticipaci√≥n.",
          "Esto significa que NO puedes reservar para hoy.",
          "La fecha m√°s pr√≥xima disponible es ma√±ana.",
          "Esta validaci√≥n se aplica tanto en frontend como en backend.",
          "Si intentas hacerlo para hoy, el sistema te mostrar√° un error."
        ]
      }
    },
    "ayuda_general": {
      "keywords": ["ayuda", "soporte", "contacto", "problema t√©cnico", "error del sistema"],
      "template": {
        "steps_only": true,
        "steps": [
          "Si tienes problemas t√©cnicos que no puedo resolver, contacta al administrador del sistema.",
          "Para dudas sobre pol√≠ticas internas del colegio, consulta con Direcci√≥n.",
          "Para reportar errores o bugs, env√≠a un correo a soporte con detalles del problema.",
          "Estoy aqu√≠ para ayudarte con preguntas sobre c√≥mo usar el sistema. üòä"
        ]
      }
    }
  },
  "voice_commands": {
    "navigate": {
      "keywords": ["ir a", "abre", "mu√©strame", "ll√©vame a", "navega a"],
      "actions": {
        "reservas": {"url": "?view=reservas", "description": "Abrir m√≥dulo de Reservas"},
        "prestamo": {"url": "?view=prestamo", "description": "Abrir m√≥dulo de Pr√©stamos"},
        "historial": {"url": "?view=historial", "description": "Abrir Historial"},
        "contrase√±a": {"url": "?view=password", "description": "Cambiar contrase√±a"},
        "tommibot": {"url": "?view=tommibot", "description": "Abrir Tommibot"},
        "usuarios": {"url": "?view=usuarios", "description": "Gestionar usuarios (Admin)"},
        "reportes": {"url": "?view=reportes", "description": "Ver reportes (Admin)"},
        "estadisticas": {"url": "?view=estadisticas", "description": "Ver estad√≠sticas (Admin)"},
        "devolucion": {"url": "?view=devolucion", "description": "Gestionar devoluciones (Encargado)"}
      }
    },
    "download": {
      "keywords": ["descargar", "descarga", "pdf", "exportar"],
      "description": "Descarga el PDF del historial actual"
    },
    "help": {
      "keywords": ["ayuda", "comandos", "qu√© puedes hacer", "opciones"],
      "description": "Muestra lista de comandos de voz disponibles"
    }
  },
  "faqs": {
    "diferencia_aulas": {
      "question": "¬øCu√°l es la diferencia entre aulas AIP y REGULARES?",
      "answer": "Las aulas AIP (Aula de Innovaci√≥n Pedag√≥gica) como AIP1 y AIP2 son espacios especiales que se RESERVAN completas para dar clases. Las aulas REGULARES son salones normales donde solo solicitas PR√âSTAMOS de equipos (laptop, proyector, etc.) para llevar a tu clase. En Reservas solo ves aulas AIP. En Pr√©stamos solo ves aulas REGULARES."
    },
    "por_que_no_veo_aula_regular_reserva": {
      "question": "¬øPor qu√© no veo aulas REGULARES cuando quiero hacer una reserva?",
      "answer": "Porque las aulas REGULARES NO se reservan. Solo puedes solicitar pr√©stamos de equipos para usar en esas aulas. Si quieres reservar un aula completa, usa las aulas AIP (AIP1, AIP2) que aparecen en el m√≥dulo de Reservas."
    },
    "por_que_no_veo_aula_aip_prestamo": {
      "question": "¬øPor qu√© no veo aulas AIP cuando pido un pr√©stamo?",
      "answer": "Porque las aulas AIP se reservan completas, no se prestan equipos individuales para ellas. Para pr√©stamos de equipos (laptop, proyector, etc.) solo puedes seleccionar aulas REGULARES, que son salones normales donde llevar√°s los equipos."
    },
    "sms_no_llega": {
      "question": "¬øQu√© hago si no me llega el SMS?",
      "answer": "Verifica que tu n√∫mero en el perfil est√© en formato +51XXXXXXXXX. Si est√° correcto, usa el bot√≥n 'Reenviar' (espera 60 seg). Si sigue sin llegar, contacta al administrador."
    },
    "cancelar_fuera_plazo": {
      "question": "¬øPuedo cancelar una reserva de ayer?",
      "answer": "No, solo se pueden cancelar reservas el mismo d√≠a. Si ya pas√≥ el d√≠a, la reserva queda registrada en el historial."
    },
    "equipo_danado": {
      "question": "¬øQu√© pasa si da√±o un equipo?",
      "answer": "Informa inmediatamente al Encargado. √âl registrar√° el incidente en la devoluci√≥n con un comentario. Luego se aplicar√°n las pol√≠ticas del colegio sobre equipos da√±ados."
    },
    "cambiar_reserva": {
      "question": "¬øPuedo modificar una reserva?",
      "answer": "No hay opci√≥n de edici√≥n directa. Deber√°s cancelar la reserva (si est√°s en el mismo d√≠a) y crear una nueva."
    }
  },
  "out_of_scope": {
    "examples": ["clima", "capital de", "noticias", "m√∫sica", "juego"],
    "response": {
      "summary": "Puedo responder preguntas generales con IA, pero mi especialidad es el sistema.",
      "steps": [
        "Puedo ayudarte con: reservas, pr√©stamos, historial, contrase√±as, devoluciones, reportes, estad√≠sticas, gesti√≥n de usuarios.",
        "Dime qu√© tarea del sistema quieres realizar y te gu√≠o paso a paso.",
        "Tambi√©n puedo responder preguntas generales como: ¬øQu√© hora es? ¬øCu√°l es la capital de Per√∫? ¬øCu√©ntame un chiste!"
      ]
    }
  },
  "system_info": {
    "name": "Sistema de Reservas y Pr√©stamos AIP",
    "institution": "Colegio Juan Tomis Stack",
    "version": "2.0",
    "features": [
      "Reserva de aulas AIP con verificaci√≥n SMS autom√°tica (solo Profesores)",
      "Pr√©stamo de equipos para aulas REGULARES (Laptop, Proyector, Extensi√≥n, etc.) con SMS",
      "Separaci√≥n clara: Aulas AIP solo para reservas, Aulas REGULARES solo para pr√©stamos",
      "Historial completo con descargas PDF",
      "Gesti√≥n de usuarios (Admin)",
      "Reportes y estad√≠sticas avanzadas con gr√°ficos (Admin)",
      "Control de devoluciones con inspecci√≥n f√≠sica (Encargado)",
      "Notificaciones en tiempo real (correo + campanita)",
      "Cambio de contrase√±a seguro con SMS (Profesores)",
      "Chatbot inteligente (Tommibot) con IA Google Gemini y comandos de voz"
    ],
    "tipos_aulas": {
      "AIP": "Aulas de Innovaci√≥n Pedag√≥gica (AIP1, AIP2). Se RESERVAN completas para dar clases. Solo aparecen en el m√≥dulo de RESERVAS.",
      "REGULAR": "Aulas normales. NO se reservan completas. Solo se solicitan PR√âSTAMOS de equipos para usar en ellas. Solo aparecen en el m√≥dulo de PR√âSTAMOS."
    },
    "roles": {
      "Profesor": "Puede hacer reservas de aulas AIP, solicitar pr√©stamos de equipos (con aulas REGULARES), ver su historial personal, cancelar reservas (mismo d√≠a), cambiar contrase√±a. SIEMPRE requiere verificaci√≥n SMS al entrar a Reservas, Pr√©stamos o Cambiar Contrase√±a. El SMS se env√≠a AUTOM√ÅTICAMENTE al abrir el m√≥dulo.",
      "Administrador": "Gesti√≥n COMPLETA: usuarios, reportes, estad√≠sticas, aulas (AIP y REGULAR), equipos, tipos de equipo, historial global de todos los usuarios. NO requiere SMS. Puede ver gr√°ficos, rankings, exportar PDFs filtrados, y configurar el sistema.",
      "Encargado": "Controla las devoluciones f√≠sicas de equipos, valida pr√©stamos, inspecciona estado de equipos, registra incidencias, y puede ver historial global. NO requiere SMS. Es responsable del inventario f√≠sico."
    },
    "sms_flow": "IMPORTANTE: Al entrar a Reservas, Pr√©stamos o Cambiar Contrase√±a, el PROFESOR recibe AUTOM√ÅTICAMENTE un c√≥digo SMS de 6 d√≠gitos. Debe ingresar ese c√≥digo en la ventana emergente para poder continuar. Sin el c√≥digo correcto, no podr√° realizar ninguna acci√≥n. El c√≥digo expira en 10 minutos."
  }
}
